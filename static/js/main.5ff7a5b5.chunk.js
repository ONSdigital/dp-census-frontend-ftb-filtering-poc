(this["webpackJsonpdp-census-frontend-ftb-filtering-poc"]=this["webpackJsonpdp-census-frontend-ftb-filtering-poc"]||[]).push([[0],{10:function(e,t,a){},23:function(e,t,a){e.exports=a.p+"static/media/Census2021_whiteback.3edebd2f.png"},24:function(e){e.exports=JSON.parse('{"dataset":{"name":"Example","digest":"24aca09d162196ce64c5801321fb31e8eab8670dae0a4a2859f560e979bcc556","description":"Example dataset for validation","size":7,"ruleRootVariable":"city"},"codebook":[{"name":"city","label":"City","codes":["0","1","2"],"labels":["London","Liverpool","Belfast"]},{"name":"sex","label":"Sex","codes":["0","1"],"labels":["Male","Female"]},{"name":"siblings","label":"Number of siblings","codes":["0","1","2","3","4","5","6"],"labels":["No siblings","1 sibling","2 siblings","3 siblings","4 siblings","5 siblings","6 or more siblings"]},{"name":"siblings_3","label":"Number of siblings (3 mappings)","codes":["0","1-2","3+"],"labels":["No siblings","1 or 2 siblings","3 or more siblings"],"mapFrom":["siblings"],"mapFromCodes":["0","1-2","","3+","","",""]}]}')},25:function(e){e.exports=JSON.parse('[{"name":"Example","digest":"24aca09d162196ce64c5801321fb31e8eab8670dae0a4a2859f560e979bcc556","description":"Example dataset for validation","size":7,"ruleRootVariable":"city"}]')},28:function(e,t,a){e.exports=a(40)},33:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(22),l=a.n(s),r=(a(33),a(10),a(13)),o=a.n(r),c=a(15),m=a(16),d=a(3),u=a(4),p=a(12),h=a(6),f=a(5),g=a(23),b=a.n(g),v=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return i.a.createElement("header",null,i.a.createElement("div",{className:"wrapper"},i.a.createElement("div",{className:"header col-wrap"},i.a.createElement("div",{className:"col"},i.a.createElement("img",{className:"logo top-logo",src:"https://cdn.ons.gov.uk/assets/images/ons-logo/v2/ons-logo.svg",alt:"Office for National Statistics"}),i.a.createElement("img",{className:"logo top-logo",src:b.a,alt:"Census 2021 logo"})))),i.a.createElement("div",{className:"primary-nav print--hide page-title font-size--sm"}))}}]),a}(i.a.Component),E=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return i.a.createElement("footer",{className:"footer"},i.a.createElement("img",{className:"footer-license__img",alt:"OGL",src:"https://cdn.ons.gov.uk/assets/images/logo-ogl-footer.svg",width:"60"}),i.a.createElement("p",{className:"footer-license__text margin-left-sm--0"},"All content is available under the ",i.a.createElement("a",{className:"icon--hide",href:"http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",target:"_blank",rel:"noopener noreferrer"},"Open Government Licence v3.0")," ",i.a.createElement("span",{className:"icon icon-external--light-small"}),", except where otherwise stated"))}}]),a}(i.a.Component),k=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){return Object(d.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("li",{id:"filter-option",className:"white-background margin-left-md--2 margin-right-md--2 margin-right-sm--1 margin-left-sm--1 filter-overview__add"},i.a.createElement("div",{className:"col--lg-56 min-height--10 padding-left-sm--0 padding-left-md--1"},i.a.createElement("div",{className:"col col--md-8 col--lg-8 min-height--4"},i.a.createElement("a",{className:"filter-overview__link--add",href:"#",onClick:function(){e.props.dimClicked(!0)}},i.a.createElement("span",{className:"dimension-button btn btn--tertiary margin-left-md--2 margin-left-sm--1  font-weight-700 "},"Add ",i.a.createElement("span",{className:"visuallyhidden"},this.props.label)))),i.a.createElement("div",{className:"dimension-name col col--md-11 col--lg-14 margin-left-sm--6 height-sm--3 height-md--6 overflow--hidden margin-top-md--3 margin-bottom-sm--2"},i.a.createElement("strong",null,i.a.createElement("span",{id:"filter-option-label",className:"font-size-16"},this.props.label))),i.a.createElement("div",{id:"number-added-aggregate",className:"col col--md-20 col--lg-30"},i.a.createElement("div",{className:"font-size--16 height-sm--3 height-md--10 nowrap-sm vertical-align-middle margin-left-sm--4 list--ellipses-sm overflow--hidden"},i.a.createElement("div",{className:"height-sm--3 max-height-md--9 vertical-align-middle__contents--md list--ellipses-md"},i.a.createElement("ul",{className:"list list--pipe-seperated list--pipe-seperated-ellipses"},i.a.createElement("span",null,"Nothing added")))))))}}]),a}(i.a.Component),w=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return this.props.showDim?i.a.createElement("div",{className:"wrapper adjust-font-size--16 page-content link-adjust background--gallery"},i.a.createElement("ul",{className:"list--neutral filter-overview"},i.a.createElement("li",{className:"margin-left--0 padding-bottom--2 padding-top--0 padding-right--2 width-lg--56"},i.a.createElement("button",{className:"float-el--right-md float-el--right-sm float-el--right-lg",href:"/filters/c53f1a7c-ecf1-4abf-a104-f8f00cd57994/dimensions/clear-all"},"Clear filters")),this.props.dimensions),i.a.createElement("div",{className:"btn--no-click padding-bottom--4 padding-left--2 padding-top--2"},i.a.createElement("div",{className:"filter-overview__error-container",id:"error-container"}),i.a.createElement("form",{method:"post",action:"/filters/c53f1a7c-ecf1-4abf-a104-f8f00cd57994/submit"},i.a.createElement("input",{id:"preview-download",type:"button",value:"Apply filters",className:"btn btn--primary btn--primary-disabled btn--thick btn--wide btn--big btn--focus margin-right--2 font-weight-700 font-size--17",name:"preview-and-download"})))):null}}]),a}(i.a.Component),N=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).saveSelection=n.saveSelection.bind(Object(p.a)(n)),n}return Object(u.a)(a,[{key:"checkChanged",value:function(e,t){e=e.toString(),this.setState(Object(m.a)({},e,t.target.checked))}},{key:"saveSelection",value:function(){var e=[];for(var t in this.state)1==t&&e.push(t);this.props.filterUpdate(this.props.dimCodeBook.name,e)}},{key:"render",value:function(){var e=this;if(!this.props.showDim)return null;for(var t=[],a=function(a){t.push(i.a.createElement("div",{className:"checkbox hierarchy-box border-bottom--gallery-sm border-bottom--gallery-md margin-bottom--1 clearfix"},i.a.createElement("div",{className:"width-md--25 float-el--left-md"},i.a.createElement("input",{type:"checkbox",className:"checkbox__input js-filter",id:"id"+a,name:e.props.dimCodeBook.codes[a],onChange:function(t){e.checkChanged(e.props.dimCodeBook.codes[a],t)}}),i.a.createElement("label",{id:e.props.dimCodeBook.codes[a],className:"checkbox__label",htmlFor:"id"+a},e.props.dimCodeBook.labels[a]))))},n=0;n<this.props.dimCodeBook.labels.length;n++)a(n);return i.a.createElement("div",{className:"wrapper"},i.a.createElement("div",{className:"col col--md-50 col--lg-35"},i.a.createElement("fieldset",null,i.a.createElement("legend",null,i.a.createElement("h2",{className:"font-size--17 padding-bottom--1 font-weight-700"},"Browse ",i.a.createElement("span",{className:"visuallyhidden"},"Aggregate"))),i.a.createElement("input",{name:"save-and-return",className:"hidden",type:"submit",value:"Save and return"}),i.a.createElement("input",{className:"btn btn--link underline-link js-filter add-all",type:"submit",value:"Add all",name:"add-all",id:"add-all","aria-label":"Add all Aggregate in this list to your saved items"}),"\xa0 \xa0",i.a.createElement("input",{className:"btn btn--link underline-link js-filter remove-list js-hidden",type:"submit",value:"Remove all",name:"remove-all",id:"remove-all","aria-label":"Remove all Aggregate in this list from your saved items"}),i.a.createElement("input",{name:"q",type:"hidden",value:"/","aria-contols":"checkboxes-0"}),t),i.a.createElement("div",{className:"margin-top js-hidden"},i.a.createElement("input",{type:"submit",value:"Add selected filters",className:"btn btn--secondary btn--focus font-weight-700 font-size--17 text-wrap"})),i.a.createElement("div",{id:"save-and-return-container",className:"margin-top--5"},i.a.createElement("input",{name:"save-and-return",className:"btn btn--primary btn--thick btn--wide btn--big btn--focus margin-right--2 font-weight-700 font-size--17 text-wrap save-button-bottom",type:"button",value:"Save and return",onClick:this.saveSelection}))))}}]),a}(i.a.Component),O=a(24);function y(e){return e.warn?i.a.createElement("div",{className:"warning wrapper"},"Connection to ONS FTB instance failed, using Mock data on the frontend instead"):null}var j=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={name:""},n.dimensionClickedFuncs=[],n.filterUpdateFunc=n.filterUpdateFunc.bind(Object(p.a)(n)),n}return Object(u.a)(a,[{key:"filterUpdateFunc",value:function(e,t){var a=Object(m.a)({},e,t),n=Object.assign(this.state.filter,a);this.setState({filter:n})}},{key:"componentDidMount",value:function(){var e=this.props.match.params.name;this.setState({name:e,codeBook:{},indexAddingDimOpt:-1,warning:!1,filter:{}}),this.getCodeBook()}},{key:"getCodeBook",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n,i,s,l,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET"},a=!1,e.prev=2,e.next=5,fetch(this.ftbDomain+"/codebook"+this.props.match.params.name,t);case 5:return i=e.sent,e.next=8,i.json();case 8:n=e.sent,a=!0,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),a=!1,n=O;case 16:if(null!=n&&null!=n.codebook)for(s=function(e){r.dimensionClickedFuncs.push((function(){r.setState({indexAddingDimOpt:e})}))},l=0;l<n.codebook.length;l++)s(l);this.setState({codeBook:n,warning:!a});case 18:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=[];if(null!=this.state.codeBook&&null!=this.state.codeBook.codebook){for(var a=this.state.codeBook.codebook,n=0;n<a.length;n++){var s=i.a.createElement(k,{label:a[n].label,dimClicked:this.dimensionClickedFuncs[n]});t.push(s)}e=i.a.createElement(N,{showDim:this.state.indexAddingDimOpt>-1,dimCodeBook:this.state.codeBook.codebook[this.state.indexAddingDimOpt],filterUpdate:this.filterUpdateFunc})}return i.a.createElement("div",null,i.a.createElement(v,null),i.a.createElement(y,{warn:this.state.warning}),i.a.createElement("h1",{className:"wrapper"},"Dataset: ",this.props.match.params.name),i.a.createElement(w,{showDim:this.state.indexAddingDimOpt<0,dimensions:t}),e,i.a.createElement(E,null))}}]),a}(i.a.Component),x=a(25);function C(e){return e.warn?i.a.createElement("div",{className:"warning wrapper"},"Connection to ONS FTB instance failed, using Mock data on the frontend instead"):null}var _=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).ftbDomain="http://99.80.12.125:10100/v6",n.state={results:[],warning:!1},n.state={searchString:"",results:[],warning:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.getDatasets()}},{key:"getDatasets",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,a,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET"},a=!1,e.prev=2,e.next=5,fetch(this.ftbDomain+"/datasets",t);case 5:return i=e.sent,e.next=8,i.json();case 8:n=e.sent,console.log("response.status"),console.log(i.status),a=200==i.status,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),a=!1;case 17:return a||(n=x),this.setState({results:n,warning:!a}),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e;return this.state.results.length>0&&(e=this.state.results.map((function(e){return i.a.createElement("li",{className:"col col--md-34 col--lg-50 search-results__item search-result-item"},i.a.createElement("a",{href:document.location.href+"/dataset/"+e.name},e.name),i.a.createElement("p",{className:"search-results__meta"},e.description))}))),i.a.createElement("div",{className:"wrapper"},i.a.createElement(C,{warn:this.state.warning}),i.a.createElement("h1",{className:"wrapper"},"List of all datasets loaded in from FTB"),i.a.createElement("div",{className:"search-results"},i.a.createElement("ul",{className:"list--neutral flush"},e)))}}]),a}(i.a.Component),B=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return console.log("got in here"),i.a.createElement("div",null,i.a.createElement(v,null),i.a.createElement(_,null),i.a.createElement(E,null))}}]),a}(i.a.Component),S=a(26),D=a(1);var A=function(){return console.log("should route"),i.a.createElement(S.a,null,i.a.createElement("div",null,i.a.createElement(D.c,null,i.a.createElement(D.a,{path:"/dp-census-frontend-ftb-filtering-poc/dataset/:name",component:j}),i.a.createElement(D.a,{path:"/dp-census-frontend-ftb-filtering-poc/",component:B,exact:!0}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.5ff7a5b5.chunk.js.map